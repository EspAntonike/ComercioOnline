{% extends 'base.html' %}
{% block title %}Listado · Admin{% endblock %}
{% block nav %}
  <a class="ml-4 hover:text-slate-900" href="/admin/new">Nuevo</a>
{% endblock %}
{% block content %}
<h1 class="text-2xl font-semibold mb-6">Productos</h1>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="space-y-2 mb-6">
      {% for cat, msg in messages %}
        <div class="p-3 rounded border {{ 'border-green-300 bg-green-50' if cat=='success' else 'border-red-300 bg-red-50' }}">{{ msg }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<div class="overflow-x-auto rounded-2xl border border-slate-200">
  <table class="min-w-full text-sm">
    <thead class="bg-slate-50">
      <tr>
        <th class="text-left p-3">ID</th>
        <th class="text-left p-3">Categoría</th>
        <th class="text-left p-3">Nombre</th>
        <th class="text-left p-3">Imagen</th>
        <th class="text-left p-3">Creado</th>
        <th class="text-left p-3">Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for p in products %}
      <tr class="border-t">
        <td class="p-3">{{ p.id }}</td>
        <td class="p-3">{{ p.category }}</td>
        <td class="p-3">{{ p.name }}</td>
        <td class="p-3">
          {% if p.image_path %}
            <img src="{{ p.image_path }}" class="h-12 w-12 object-cover rounded-md" />
          {% else %}
            <span class="text-slate-400">—</span>
          {% endif %}
        </td>
        <td class="p-3">{{ p.created_at }}</td>
        <td class="p-3">
          <form action="/admin/delete/{{ p.id }}" method="post" onsubmit="return confirm('¿Eliminar este producto?')">
            <button class="px-3 py-1 rounded-lg bg-red-600 text-white hover:bg-red-500">Eliminar</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
